# 对话总结：本地开发环境故障排除 (2025-07-26)

本次对话的核心目标是在本地成功运行 `market-pulse` 项目的开发环境。我们经历了一系列复杂的故障排查，最终定位到问题的根源。

## 问题演进与排查过程

1.  **初始启动失败**:
    *   **现象**: 使用 `start-dev.bat` 启动后，前端页面无法连接，或显示“无法加载市场数据”。
    *   **排查**: 发现批处理脚本启动的后端或前端进程不稳定，容易在后台出错并退出。

2.  **切换到 Docker 环境后出现 404 错误**:
    *   **现象**: 使用 `docker-compose` 启动后，前端请求后端 `/api/market/data` 接口时返回 404 (Not Found) 错误。
    *   **排查**:
        *   检查本地代码，发现 `/api/market/data` 路由和处理器函数**确实存在**。
        *   检查 Docker 容器日志 (`docker logs`)，发现容器内运行的服务**并未注册**该路由。
    *   **结论**: Docker 在构建镜像时使用了**陈旧的缓存**，没有把最新的本地代码打包进去。
    *   **解决方案**: 使用 `docker-compose up --build` 强制重新构建镜像。

3.  **同步代码版本后出现 500 错误 (网络超时)**:
    *   **背景**: 用户确认本地代码与服务器版本不一致，我们使用 `git reset --hard` 将本地代码与 `origin/master` 同步。
    *   **现象**: 采用“混合模式”（Docker 运行数据库，本地运行 Go 后端）后，前端请求 API 时返回 500 (Internal Server Error)。
    *   **排查**: 后端日志显示，在尝试连接外部 CoinGecko API (`https://api.coingecko.com`) 时发生 `net/http: TLS handshake timeout` 网络超时错误。

4.  **定位到编辑器终端环境问题 (核心)**:
    *   **现象**: `curl` 命令和 Go 程序在**编辑器 (Cursor) 的内部终端**中访问 CoinGecko 时会失败，但在**外部独立的 Windows PowerShell 终端**中却能成功。
    *   **排查**:
        *   在编辑器终端中发现了 `http_proxy=127.0.0.1:7890` 的环境变量。
        *   尝试在终端中手动清除该环境变量 (`$Env:http_proxy = ""`)，但问题依旧存在。
    *   **最终结论**: 问题根源在于编辑器本身或其某个组件，以一种比环境变量更底层的方式，强制拦截并代理了其内部终端的所有网络请求。这个代理是失效的，导致了所有网络连接失败。这是一个非常特殊且顽固的编辑器环境问题。

## 最终决定

由于无法轻易改变编辑器内部顽固的网络行为，为了提高开发效率，最终决定**放弃在问题重重的本地环境中进行调试，转移到网络环境纯净、配置一致的服务器上进行开发**。 